## Getting Started with Firecracker

### Installation

```bash
# Download Firecracker binary
ARCH="$(uname -m)"
release_url="https://github.com/firecracker-microvm/firecracker/releases"
latest=$(basename $(curl -fsSLI -o /dev/null -w %{url_effective} ${release_url}/latest))
curl -L ${release_url}/download/${latest}/firecracker-${latest}-${ARCH}.tgz | tar -xz

# Move to system path
sudo mv release-${latest}-$(uname -m)/firecracker-${latest}-${ARCH} /usr/local/bin/firecracker
```

### Building a Kernel for Firecracker

Firecracker requires a Linux kernel configured specifically for its use case:

```bash
# Clone Linux kernel
git clone https://github.com/torvalds/linux.git
cd linux
git checkout v5.10

# Use Firecracker's recommended kernel config
curl -o .config https://raw.githubusercontent.com/firecracker-microvm/firecracker/main/resources/guest_configs/microvm-kernel-x86_64-5.10.config

# Build the kernel
make vmlinux -j$(nproc)
```

### Creating a Root Filesystem

```bash
# Create a minimal Alpine Linux rootfs
dd if=/dev/zero of=rootfs.ext4 bs=1M count=512
mkfs.ext4 rootfs.ext4

# Mount and populate
mkdir temp-mount
sudo mount rootfs.ext4 temp-mount

# Install Alpine Linux base
sudo docker run -it --rm -v $(pwd)/temp-mount:/mnt alpine sh -c \
  "apk add openrc util-linux && \
   setup-alpine -q && \
   cp -a /bin /etc /lib /sbin /usr /mnt/"

sudo umount temp-mount
```

### Launching Your First MicroVM

```bash
# Start Firecracker API server
rm -f /tmp/firecracker.socket
firecracker --api-sock /tmp/firecracker.socket

# In another terminal, configure the VM
curl --unix-socket /tmp/firecracker.socket -i \
  -X PUT 'http://localhost/boot-source' \
  -H 'Accept: application/json' \
  -H 'Content-Type: application/json' \
  -d '{
    "kernel_image_path": "./vmlinux",
    "boot_args": "console=ttyS0 reboot=k panic=1 pci=off"
  }'

# Configure the root filesystem
curl --unix-socket /tmp/firecracker.socket -i \
  -X PUT 'http://localhost/drives/rootfs' \
  -H 'Accept: application/json' \
  -H 'Content-Type: application/json' \
  -d '{
    "drive_id": "rootfs",
    "path_on_host": "./rootfs.ext4",
    "is_root_device": true,
    "is_read_only": false
  }'

# Configure machine resources
curl --unix-socket /tmp/firecracker.socket -i \
  -X PUT 'http://localhost/machine-config' \
  -H 'Accept: application/json' \
  -H 'Content-Type: application/json' \
  -d '{
    "vcpu_count": 2,
    "mem_size_mib": 1024
  }'

# Start the instance
curl --unix-socket /tmp/firecracker.socket -i \
  -X PUT 'http://localhost/actions' \
  -H 'Accept: application/json' \
  -H 'Content-Type: application/json' \
  -d '{
    "action_type": "InstanceStart"
  }'
```